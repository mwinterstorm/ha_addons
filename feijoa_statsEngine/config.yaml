name: Feijoa Stats Engine Importer
slug: feijoa_stats_engine
description: Import Feijoa contributions from S3 into MariaDB for Home Assistant dashboards.
url: https://github.com/mwinterstorm/ha_addons/feijoa_statsEngine/README.md

version: "0.0.1"
stage: experimental

arch:
  - amd64
  - aarch64
  - armv7

startup: application
boot: auto
init: false
# watchdog: [string] A URL for monitoring the add-on health. Like http://[HOST]:[PORT:2839]/dashboard, the port needs the internal port, which will be replaced with the effective port. It is also possible to bind the protocol part to a configuration option with: [PROTO:option_name]://[HOST]:[PORT:2839]/dashboard and it's looked up if it is true and it's going to https. For simple TCP port monitoring you can use tcp://[HOST]:[PORT:80]. It works for add-ons on the host or internal network.

# webui: [string] A URL for the web interface of this add-on. Like http://[HOST]:[PORT:2839]/dashboard, the port needs the internal port, which will be replaced with the effective port. It is also possible to bind the protocol part to a configuration option with: [PROTO:option_name]://[HOST]:[PORT:2839]/dashboard and it's looked up if it is true and it's going to https.
# ports: [dict] Network ports to expose from the container. Format is "container-port/type": host-port. If the host port is null then the mapping is disabled.
map:
  - share:rw

backup: hot

panel_admin: true

audio: false
uart: false
gpio: false
i2c: false
usb: false
gpio_access: false

docker_api: false
homeassistant_api: false
hassio_api: false

host_network: false
ingress: false

panel_icon: mdi:database-import

services:
  - mysql:need

options:
  aws_access_key_id: ""
  aws_secret_access_key: ""
  aws_region: ap-southeast-2
  s3_bucket: ""
  s3_prefix: new_contributions/
  chunk_size: 1000
  users_chunk_size: 1000
  use_cron: false
  schedule: "0 3 * * *"
  mariadb_host: core-mariadb
  mariadb_port: 3306
  mariadb_user: ""
  mariadb_password: ""
  mariadb_database: feijoa
  timezone: Pacific/Auckland
  log_level: info

schema:
  aws_access_key_id: str
  aws_secret_access_key: str
  aws_region: str
  s3_bucket: str
  s3_prefix: str
  chunk_size: int
  users_chunk_size: int
  use_cron: bool
  schedule: str?
  mariadb_host: str
  mariadb_port: int
  mariadb_user: str
  mariadb_password: str
  mariadb_database: str
  timezone: str
  log_level: list(debug|info|warning|error)

environment:
  APP_HOME: /usr/local/share/feijoa
